{% use 'bootstrap_4_layout.html.twig' %}

{# Rows #}
{% block form_row -%}
	<div class="form-group">
		{{- form_label(form) -}}
		{{- form_widget(form) -}}
		{{- form_errors(form) -}}
	</div>
{%- endblock form_row %}

{# Labels #}
{%- block form_label -%}
	{% if label is not same as(false) -%}
		{% set label_attr = label_attr|merge({class: (label_attr.class|default('') ~ ' form-control-label')|trim}) %}
		{% set label_attr = label_attr|merge({'for': id}) %}
		{% if required -%}
			{% set label_attr = label_attr|merge({'class': (label_attr.class|default('') ~ ' required')|trim}) %}
		{%- endif -%}
		{% if label is empty -%}
			{%- if label_format is not empty -%}
				{% set label = label_format|replace({
					'%name%': name,
					'%id%': id,
				}) %}
			{%- else -%}
				{% set label = name|humanize %}
			{%- endif -%}
		{%- endif -%}
		<label{% if label_attr %}{% with { attr: label_attr } %}{{ block('attributes') }}{% endwith %}{% endif %}>
			{{- translation_domain is same as(false) ? label : label|trans({}, translation_domain) -}}
		</label>
	{%- endif -%}
{%- endblock form_label -%}

{# Widgets #}
{% block choice_widget_collapsed -%}
	{% if multiple %}
		{%- set attr = attr|merge({class: (attr.class|default('') ~ ' select2')|trim}) -%}
	{% else %}
		{%- set attr = attr|merge({class: (attr.class|default('') ~ ' custom-select')|trim}) -%}
	{% endif %}
	{{- parent() -}}
{%- endblock choice_widget_collapsed %}

{% block date_widget -%}
	{%- if widget == 'single_text' %}
		{% set attr = attr|merge({class: (attr.class|default('') ~ ' datepicker')|trim}) %}
	{%- else -%}
		{%- if not valid -%}
			{% set attr = attr|merge({class: (attr.class|default('') ~ ' form-control is-invalid')|trim}) -%}
			{% set valid = true %}
		{%- endif -%}
	{%- endif -%}
	{{- parent() -}}
{%- endblock date_widget %}

{# Custom #}
{% block duo_tab_label %}
	{% set selected = selected | default(false) %}
	<a href="#{{ id }}_tab" id="{{ id }}_nav" class="nav-item nav-link{% if selected %} active{% endif %}" data-toggle="tab" role="tab" aria-controls="{{ id }}_tab" aria-selected="{{ selected }}">
		{{- label | trans({}, translation_domain) -}}
	</a>
{% endblock %}

{% block duo_tab_widget %}
	{% set selected = selected | default(false) %}
	<div class="tab-pane fade{% if selected %} show active{% endif %}" id="{{ id }}_tab" role="tabpanel" aria-labelledby="{{ id }}_nav">
		{{- form_widget(form) -}}
	</div>
{% endblock %}

{% block duo_tabs_row %}
	<div id="{{ id }}" class="tabs-list">
		<ul class="nav nav-tabs mb-3" role="tablist">
			{% for tab in form %}
				<li>{{ form_label(tab, null, { selected: loop.first }) }}</li>
			{% endfor %}
		</ul>
		<div class="tab-content">
			{% for tab in form %}
				{{ form_widget(tab, { selected: loop.first }) }}
			{% endfor %}
		</div>
	</div>
{% endblock %}

{% block duo_translation_row %}
	{% set locales = get_locales(app.request.locale) %}
	<div id="{{ id }}" class="translations-list">
		<div class="row">
			<div class="col-md-3">
				<div class="list-group mb-3" id="{{ id }}_tablist" role="tablist">
					{% for locale, child in form %}
						<a class="list-group-item list-group-item-action{% if locale == app.request.locale %} active{% endif %}" id="{{ child.vars.id }}_list" data-toggle="list" href="#{{ child.vars.id }}" role="tab" aria-controls="{{ child.vars.id }}">
							{{- attribute(locales, locale) | default(locale | upper) -}}
						</a>
					{% endfor %}
				</div>
			</div>
			<div class="col-md-9">
				<div class="tab-content" id="{{ id }}_content">
					{% for locale, child in form %}
						<div class="tab-pane fade show{% if locale == app.request.locale %} active{% endif %}" id="{{ child.vars.id }}" role="tabpanel" aria-labelledby="{{ child.vars.id }}_list">
							{{- form_widget(child) -}}
						</div>
					{% endfor %}
				</div>
			</div>
		</div>
	</div>
{% endblock %}