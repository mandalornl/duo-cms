{% spaceless %}
{% import '@DuoMedia/Marco/srcset.html.twig' as media %}
<div class="table-responsive">
	<table class="table table-hover table-striped checkable">
		<thead>
			<tr>
				{% if not app.request.query.get('iframe') %}
					<th>
						<div class="custom-control custom-checkbox">
							<input type="checkbox" id="{{ checkboxId }}_all" class="custom-control-input"{% if not paginator.count %} disabled{% endif %}>
							<label for="{{ checkboxId }}_all" class="custom-control-label"></label>
						</div>
					</th>
				{% endif %}
				<th>&nbsp;</th>
				{% for field in list.fields %}
					<th{% if field.sortable %} class="sortable"{% endif %}>
						{% if field.sortable %}
							{% if list.sorting and list.sorting.sort == field.hash %}
								{% set url = path(routePrefix ~ '_sorting', app.request.query.all | merge({ sort: field.hash, order: list.sorting.order == 'asc' ? 'desc' : 'asc' })) %}
							{% else %}
								{% set url = path(routePrefix ~ '_sorting', app.request.query.all | merge({ sort: field.hash, order: 'asc' })) %}
							{% endif %}
							<a href="{{ url }}">
								{{- field.label | trans }}{% if list.sorting and list.sorting.sort == field.hash %} <i class="icon-sort-{{ list.sorting.order }}"></i>{% endif %}
							</a>
						{% else %}
							{{- field.label | trans -}}
						{% endif %}
					</th>
				{% endfor %}
				{% if not app.request.query.get('iframe') %}
					<th>&nbsp;</th>
				{% endif %}
			</tr>
		</thead>
		<tbody>
			{% for entity in paginator.result %}
				{% set item = null %}
				{% if app.request.query.get('iframe') %}
					{% set item = {
						id: entity.id,
						name: entity | trim,
						mimeType: entity.mimeType,
						eventType: type
					} %}
					{% if 'image/' in entity.mimeType %}
						{% set item = item | merge({
							src: entity.url | imagine_filter('srcset_680'),
							srcset: media.srcset(entity.url, [680, 768, 1024])
						}) %}
					{% endif %}
				{% endif %}
				<tr{% if item %} data-item="{{ item | json_encode }}"{% else %} data-url="{{ path(routePrefix ~ '_update', { id: entity.id }) }}" title="{{ 'duo.admin.listing.action.edit' | trans }}"{% endif %}>
					{% if not app.request.query.get('iframe') %}
						<td>
							<div class="custom-control custom-checkbox">
								<input type="checkbox" id="{{ checkboxId }}_{{ entity.id }}" class="custom-control-input" name="ids[]" value="{{ entity.id }}">
								<label for="{{ checkboxId }}_{{ entity.id }}" class="custom-control-label"></label>
							</div>
						</td>
					{% endif %}
					<td>
						{% if 'image/' in entity.mimeType %}
							<div class="image-preview">
								<img src="{{ entity.url | imagine_filter('listing_preview') }}" alt="{{ entity.name }}">
							</div>
						{% endif %}
					</td>
					{% for field in list.fields %}
						<td>
							{%- if field.template -%}
								{%- include field.template -%}
							{%- else -%}
								{%- include '@DuoAdmin/Listing/Field/default.html.twig' -%}
							{%- endif -%}
						</td>
					{% endfor %}
					{% if not app.request.query.get('iframe') %}
						<td>
							{% if list.isSortable | default(false) and not entity is treeable %}
								<a href="{{ path(routePrefix ~ '_move_up', { id: entity.id }) }}" title="{{ 'duo.admin.listing.action.move_up' | trans }}">
									<i class="icon-arrow-up"></i>
								</a>
								<a href="{{ path(routePrefix ~ '_move_down', { id: entity.id }) }}" title="{{ 'duo.admin.listing.action.move_down' | trans }}">
									<i class="icon-arrow-down"></i>
								</a>
							{% endif %}
							{% if list.isDeletable | default(false) %}
								{% set url = path(routePrefix ~ '_delete', { id: entity.id }) %}
							{% else %}
								{% set url = path(routePrefix ~ '_destroy', { id: entity.id }) %}
							{% endif %}
							<a href="{{ url }}" data-modal="delete" title="{{ 'duo.admin.listing.action.delete' | trans }}">
								<i class="icon-bin"></i>
							</a>
						</td>
					{% endif %}
				</tr>
			{% endfor %}
		</tbody>
	</table>
</div>
{% endspaceless %}